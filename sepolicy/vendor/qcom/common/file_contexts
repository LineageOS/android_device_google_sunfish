###################################
# System files
#
/(vendor|system/vendor)/bin/PktRspTest          u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/hvdcp_opti          u:object_r:hvdcp_exec:s0
/(vendor|system/vendor)/bin/cnd                 u:object_r:cnd_exec:s0
/(vendor|system/vendor)/bin/diag_callback_client                u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_dci_sample                     u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_klog                           u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_mdlog                          u:object_r:qlogd_exec:s0
/(vendor|system/vendor)/bin/drmdiagapp          u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_qshrink4_daemon                u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_socket_log                     u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_uart_log                       u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/diag_buffering_test                 u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/irsc_util                           u:object_r:irsc_util_exec:s0
/(vendor|system/vendor)/bin/qrtr-cfg                            u:object_r:qrtr_exec:s0
/(vendor|system/vendor)/bin/qrtr-ns                             u:object_r:qrtr_exec:s0
/(vendor|system/vendor)/bin/init\.sensors\.sh               u:object_r:qti_init_shell_exec:s0
/(vendor|system/vendor)/bin/msm_irqbalance      u:object_r:msm_irqbalanced_exec:s0
/(vendor|system/vendor)/bin/imsdatadaemon       u:object_r:ims_exec:s0
/(vendor|system/vendor)/bin/imsqmidaemon        u:object_r:ims_exec:s0
/(vendor|system/vendor)/bin/ims_rtp_daemon      u:object_r:hal_imsrtp_exec:s0
/(vendor|system/vendor)/bin/netmgrd             u:object_r:netmgrd_exec:s0
/(vendor|system/vendor)/bin/port-bridge         u:object_r:port-bridge_exec:s0
/(vendor|system/vendor)/bin/sensors.qti         u:object_r:sensors_exec:s0
/(vendor|system/vendor)/bin/test_diag           u:object_r:diag_exec:s0
/(vendor|system/vendor)/bin/thermal-engine      u:object_r:thermal-engine_exec:s0
/system/rfs.*                                   u:object_r:rfs_system_file:s0
/(vendor|system/vendor)/bin/time_daemon         u:object_r:time_daemon_exec:s0
/(vendor|system/vendor)/bin/rmt_storage         u:object_r:rmt_storage_exec:s0
/(vendor|system/vendor)/bin/tftp_server         u:object_r:rfs_access_exec:s0
/(vendor|system/vendor)/bin/hvdcp               u:object_r:hvdcp_exec:s0
/(vendor|system/vendor)/bin/qseecomd            u:object_r:tee_exec:s0
/(vendor|system/vendor)/bin/spdaemon            u:object_r:spdaemon_exec:s0
/(vendor|system/vendor)/bin/sec_nvm             u:object_r:sec_nvm_exec:s0
/(vendor|system/vendor)/bin/cnss-daemon         u:object_r:wcnss_service_exec:s0
/(vendor|system/vendor)/bin/cnss_diag           u:object_r:wcnss_service_exec:s0
/(vendor|system/vendor)/bin/adsprpcd            u:object_r:adsprpcd_exec:s0
/(vendor|system/vendor)/bin/cdsprpcd            u:object_r:cdsprpcd_exec:s0
/(vendor|system/vendor)/bin/wpa_cli             u:object_r:wcnss_service_exec:s0
/(vendor|system/vendor)/bin/mdm_helper          u:object_r:mdm_helper_exec:s0
/(vendor|system/vendor)/bin/mdm_helper_proxy    u:object_r:mdm_helper_exec:s0
/(vendor|system/vendor)/bin/ks                                  u:object_r:mdm_helper_exec:s0
/(vendor|system/vendor)/bin/pm-service          u:object_r:vendor_per_mgr_exec:s0
/(vendor|system/vendor)/bin/pm-proxy            u:object_r:vendor_per_mgr_exec:s0
/(vendor|system/vendor)/bin/pd-mapper           u:object_r:vendor_pd_mapper_exec:s0
/(vendor|system/vendor)/bin/pd-api-test         u:object_r:vendor_pd_mapper_exec:s0
/(vendor|system/vendor)/xbin/qlogd                              u:object_r:qlogd_exec:s0
/(vendor|system/vendor)/bin/ssr_setup           u:object_r:vendor_ssr_setup_exec:s0
/(vendor|system/vendor)/bin/subsystem_ramdump   u:object_r:vendor_subsystem_ramdump_exec:s0
/(vendor|system/vendor)/bin/ssr_diag            u:object_r:vendor_ssr_diag_exec:s0
/(vendor|system/vendor)/bin/hw/qcrild           u:object_r:rild_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.drm@[0-9]+\.[0-9]+-service\.clearkey    u:object_r:hal_drm_clearkey_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.drm@[0-9]+\.[0-9]+-service\.widevine    u:object_r:hal_drm_widevine_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.gnss@.*-service-qti u:object_r:hal_gnss_qti_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.gnss@.*-service u:object_r:hal_gnss_qti_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.bluetooth@1\.0-service-qti  u:object_r:hal_bluetooth_default_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.display\.color@1\.0-service            u:object_r:hal_display_color_default_exec:s0
/vendor/bin/hw/vendor\.qti\.hardware\.mlshal@1\.0-service                          u:object_r:hal_mirrorlink_qti_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.hardware\.perf@2\.0-service            u:object_r:hal_perf_default_exec:s0
/(vendor|system/vendor)/bin/sscrpcd                                 u:object_r:sensors_exec:s0
/(vendor|system/vendor)/bin/loc_launcher        u:object_r:location_exec:s0
/(vendor|system/vendor)/bin/lowi-server         u:object_r:location_exec:s0
/(vendor|system/vendor)/bin/xtra-daemon         u:object_r:location_exec:s0
/(vendor|system/vendor)/bin/wcnss_service       u:object_r:wcnss_service_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.keymaster@3\.0-service-qti u:object_r:hal_keymaster_qti_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.keymaster@4\.0-service-qti u:object_r:hal_keymaster_qti_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.keymaster@4\.0-strongbox-service-qti u:object_r:hal_keymaster_qti_exec:s0
/(vendor|system/vendor)/bin/hw/android\.hardware\.gatekeeper@1\.0-service-qti u:object_r:hal_gatekeeper_qti_exec:s0
/(vendor|system/vendor)/bin/imsrcsd             u:object_r:hal_rcsservice_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.hardware\.qteeconnector@1\.0-service u:object_r:hal_qteeconnector_qti_exec:s0
/vendor/bin/hw/vendor\.qti\.hardware\.qseecom@1\.0-service                  u:object_r:hal_qseecom_default_exec:s0
/(vendor|system/vendor)/bin/chre                u:object_r:chre_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.hardware\.display\.allocator@1\.0-service   u:object_r:hal_graphics_allocator_default_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.hardware\.display\.allocator-service   u:object_r:hal_graphics_allocator_default_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.hardware\.tui_comm@1\.0-service-qti u:object_r:hal_tui_comm_qti_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.hardware\.sensorscalibrate@1\.0-service u:object_r:hal_sensorscalibrate_qti_default_exec:s0
/(vendor|system/vendor)/bin/hw/vendor\.qti\.media\.c2@1\.0-service u:object_r:mediacodec_exec:s0
/(vendor|system/vendor)/bin/qti                 u:object_r:qti_exec:s0

# dev socket nodes
/dev/socket/chre                                u:object_r:chre_socket:s0
/dev/socket/msm_irqbalance                      u:object_r:irqbalance_socket:s0
/dev/socket/qmux_radio(/.*)?                    u:object_r:qmuxd_socket:s0
/dev/socket/netmgr(/.*)?                        u:object_r:netmgrd_socket:s0
/dev/socket/ims_qmid                            u:object_r:ims_socket:s0
/dev/socket/ims_datad                           u:object_r:ims_socket:s0
/dev/socket/cnd                                 u:object_r:cnd_socket:s0


###################################
# persist files
#
/mnt/vendor/persist/camera(/.*)?                                               u:object_r:persist_camera_file:s0
/mnt/vendor/persist/bluetooth(/.*)?                                            u:object_r:persist_bluetooth_file:s0
/mnt/vendor/persist/drm(/.*)?                                                  u:object_r:persist_drm_file:s0
/mnt/vendor/persist/sensors(/.*)?                                              u:object_r:sensors_persist_file:s0
/mnt/vendor/persist/alarm(/.*)?                                                u:object_r:persist_alarm_file:s0
/mnt/vendor/persist/time(/.*)?                                                 u:object_r:persist_time_file:s0
/mnt/vendor/persist/data(/.*)?                                                 u:object_r:persist_drm_file:s0
/mnt/vendor/persist/data/tz(/.*)?                                              u:object_r:persist_drm_file:s0
/mnt/vendor/persist/data/sfs(/.*)?                                             u:object_r:persist_drm_file:s0
/mnt/vendor/persist/hlos_rfs(/.*)?                                             u:object_r:persist_rfs_shared_hlos_file:s0
/mnt/vendor/persist/display(/.*)?                                              u:object_r:persist_display_file:s0
/mnt/vendor/persist/rfs.*                                                      u:object_r:persist_rfs_file:s0
/mnt/vendor/persist/speccfg(/.*)?                                              u:object_r:regionalization_file:s0
/mnt/vendor/persist/misc(/.*)?                                                 u:object_r:persist_misc_file:s0
/mnt/vendor/persist/bms(/.*)?                                                  u:object_r:persist_bms_file:s0
/mnt/vendor/persist/secnvm(/.*)?                                               u:object_r:persist_secnvm_file:s0
/mnt/vendor/persist/FTM_AP(/.*)?                                               u:object_r:vendor_persist_mmi_file:s0
/mnt/vendor/persist/hvdcp_opti(/.*)?                                           u:object_r:persist_hvdcp_file:s0
/mnt/vendor/persist/audio(/.*)?                                                u:object_r:persist_audio_file:s0

###################################
# ramdumpfs files
#
/mnt/vendor/ramdump(/.*)?                       u:object_r:ramdump_vendor_mnt_file:s0
/ramdump(/.*)?                                  u:object_r:ramdump_vendor_mnt_file:s0

###################################
# adsp files
#
/(vendor|system/vendor)/dsp(/.*)?                                   u:object_r:adsprpcd_file:s0
/dsp(/.*)?                                                          u:object_r:adsprpcd_file:s0

###################################
# cache files
#

###################################
# vendor files
#
/vendor/package(/.*)?                      u:object_r:vendor_carrier_file:s0
/vendor/package(/.*)?/overlay(/.*)?        u:object_r:vendor_overlay_file:s0
/vendor/package(/.*)?/app(/.*)?            u:object_r:vendor_app_file:s0

# same-process HAL files and their dependencies
#
/vendor/lib(64)?/hw/android\.hardware\.graphics\.mapper@2\.0-impl-qti-display\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/vendor\.qti\.hardware\.display\.mapper@1\.0\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/vendor\.qti\.hardware\.display\.mapper@2\.0\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/vendor\.qti\.hardware\.display\.mapperextensions@1\.0\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/vendor\.qti\.hardware\.display\.mapperextensions@1\.1\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/hw/android\.hardware\.graphics\.mapper@3\.0-impl-qti-display\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/vendor\.qti\.hardware\.display\.mapper@3\.0\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libqdMetaData\.so         u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libgralloc\.qti\.so       u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/lib_aion_buffer\.so       u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libqservice\.so           u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libqdutils\.so            u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libadreno_utils\.so       u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libgpudataproducer\.so    u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libgsl\.so                u:object_r:same_process_hal_file:s0

/vendor/lib(64)?/libEGL_adreno\.so         u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libGLESv1_CM_adreno\.so   u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libGLESv2_adreno\.so      u:object_r:same_process_hal_file:s0

/vendor/lib(64)?/libdrmutils\.so           u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libdrm\.so                u:object_r:same_process_hal_file:s0

/vendor/lib(64)?/libavenhancements\.so     u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libgrallocutils\.so       u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libgralloccore\.so        u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libExtendedExtractor.so   u:object_r:same_process_hal_file:s0
# RenderScript dependencies.
# To test: run cts -m CtsRenderscriptTestCases
/vendor/lib(64)?/libRSDriver_adreno\.so     u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libCB\.so                  u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libllvm-qgl\.so            u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libbccQTI\.so              u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libllvm-qcom\.so           u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/librs_adreno\.so           u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/librs_adreno_sha1\.so      u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libqti-perfd-client\.so    u:object_r:same_process_hal_file:s0
# perf-hal client lib (included by libqti-perfd-client.so)
/vendor/lib(64)?/vendor\.qti\.hardware\.perf@1\.0\.so    u:object_r:same_process_hal_file:s0

# libGLESv2_adreno depends on this
/vendor/lib(64)?/libllvm-glnext\.so         u:object_r:same_process_hal_file:s0

# Game profiling library
/vendor/lib(64)?/libadreno_app_profiles\.so    u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/vendor\.qti\.qspmhal@1\.0\.so u:object_r:same_process_hal_file:s0

# libOpenCL-pixel and its dependencies
/vendor/lib(64)?/libOpenCL-pixel\.so        u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libOpenCL\.so              u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libq3dtools_adreno\.so     u:object_r:same_process_hal_file:s0

#Loaded by native loader (zygote) for all processes
/vendor/lib(64)?/libhalide_hexagon_host\.so u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libadsprpc\.so             u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libcdsprpc\.so             u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libsdsprpc\.so             u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libdiag\.so                u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libtime_genoff\.so         u:object_r:same_process_hal_file:s0

# libmmi_jni
/vendor/lib(64)?/libmmi_jni\.so             u:object_r:same_process_hal_file:s0

# Fastcv libs
/vendor/lib(64)?/libfastcvdsp_stub\.so      u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libfastcvadsp_stub\.so     u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/libfastcvopt\.so           u:object_r:same_process_hal_file:s0

# SVA files
/vendor/lib(64)?/liblistenjni\.so          u:object_r:same_process_hal_file:s0
/vendor/lib(64)?/liblistensoundmodel2\.so  u:object_r:same_process_hal_file:s0
###################################
# firmware images
#
/vendor/bt_firmware(/.*)?                                           u:object_r:bt_firmware_file:s0

#Android NN Driver
/(vendor|system/vendor)/bin/hw/android\.hardware\.neuralnetworks@1\.3-service-qti u:object_r:hal_neuralnetworks_default_exec:s0

# dev nodes
/dev/ipa                                        u:object_r:ipa_dev:s0
/dev/wwan_ioctl                                 u:object_r:ipa_dev:s0
/dev/ipaNatTable                                u:object_r:ipa_dev:s0
/dev/sg[0-9]+                                   u:object_r:sg_device:s0
/dev/qseecom                                    u:object_r:tee_device:s0
/dev/video([0-9])+                              u:object_r:video_device:s0
/dev/media([0-9])+                              u:object_r:video_device:s0
/dev/v4l-subdev.*                               u:object_r:video_device:s0
/dev/jpeg[0-9]*                                 u:object_r:video_device:s0
/dev/dri/card0                                  u:object_r:graphics_device:s0
/dev/adsprpc-smd                                u:object_r:qdsp_device:s0
/dev/adsprpc-smd-secure                         u:object_r:qdsp_device:s0
/dev/kgsl-3d0                                   u:object_r:gpu_device:s0
/dev/wlan                                       u:object_r:wlan_device:s0
/dev/smem_log                                   u:object_r:smem_log_device:s0
/dev/subsys_modem                               u:object_r:modem_ssr_device:s0
/dev/diag                                       u:object_r:diag_device:s0
/dev/sp_kernel                                  u:object_r:skp_device:s0
/dev/qsee_ipc_irq_spss                          u:object_r:qsee_ipc_irq_spss_device:s0
/dev/spcom                                      u:object_r:spcom_device:s0
/dev/sp_ssr                                     u:object_r:sp_ssr_device:s0
/dev/sp_keymaster                               u:object_r:sp_keymaster_device:s0
/dev/btpower                                    u:object_r:hci_attach_dev:s0
/dev/ttyHS0                                     u:object_r:hci_attach_dev:s0
/dev/ttyMSM0                                    u:object_r:tty_device:s0
/dev/block/sda                                  u:object_r:gpt_block_device:s0
/dev/block/sd[bc]1?                             u:object_r:xbl_block_device:s0
/dev/block/sde                                  u:object_r:boot_block_device:s0
/dev/msm_.*                                     u:object_r:audio_device:s0
/dev/ramdump_.*                                 u:object_r:ramdump_device:s0
/dev/at_.*                                      u:object_r:at_device:s0

# dev socket nodes
/dev/socket/ipacm_log_file                      u:object_r:ipacm_socket:s0
/dev/socket/location(/.*)?                      u:object_r:location_socket:s0
/dev/socket/wifihal(/.*)?                       u:object_r:wifihal_socket:s0

# files in /vendor
/vendor/bin/ipacm               u:object_r:hal_tetheroffload_default_exec:s0
/vendor/bin/ipacm-diag          u:object_r:hal_tetheroffload_default_exec:s0

# data files
/data/vendor/ipa(/.*)?                 u:object_r:ipa_vendor_data_file:s0
/data/vendor/sensors(/.*)?             u:object_r:sensors_vendor_data_file:s0
/data/vendor/rfs/mpss(/.*)?            u:object_r:mpss_rfs_data_file:s0
/data/vendor/radio(/.*)?               u:object_r:vendor_radio_data_file:s0
/data/vendor/netmgr(/.*)?              u:object_r:netmgrd_data_file:s0
/data/vendor/modem_fdr(/.*)?           u:object_r:modem_fdr_file:s0
/data/vendor/mediadrm(/.*)?            u:object_r:mediadrm_vendor_data_file:s0
/data/vendor/nnhal(/.*)?               u:object_r:hal_neuralnetworks_data_file:s0
/data/vendor/ramdump(/.*)?             u:object_r:ramdump_vendor_data_file:s0
/data/vendor/ssrdump(/.*)?             u:object_r:ramdump_vendor_data_file:s0
/data/vendor/ssrlog(/.*)?              u:object_r:ssr_log_file:s0
/data/vendor/camera(/.*)?              u:object_r:camera_vendor_data_file:s0
/data/vendor/location(/.*)?            u:object_r:location_data_file:s0
/data/vendor/tombstones/rfs(/.*)?      u:object_r:rfs_tombstone_data_file:s0
/data/vendor/audio(/.*)?               u:object_r:audio_vendor_data_file:s0
/data/vendor/display(/.*)?             u:object_r:display_vendor_data_file:s0
/data/vendor/time(/.*)?                u:object_r:time_data_file:s0

# spdaemon and sec_nvm files
/dev/spdaemon_ssr                               u:object_r:spdaemon_ssr_device:s0
/dev/sec_nvm_.*                                 u:object_r:sec_nvm_device:s0

# cnss_diag files
/data/vendor/wifi/cnss_diag(/.*)?               u:object_r:cnss_vendor_data_file:s0
/data/vendor/wifi/iotap_ps\.bin                 u:object_r:cnss_vendor_data_file:s0

/data/vendor/connectivity(/.*)?                 u:object_r:cnd_data_file:s0
